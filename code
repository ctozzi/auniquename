Here's some updated code
